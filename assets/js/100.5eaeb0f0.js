(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{510:function(t,s,e){"use strict";e.r(s);var a=e(0),l=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"mysql-启动-停止-重启mysql"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql-启动-停止-重启mysql"}},[t._v("#")]),t._v(" mysql 启动/停止/重启MySQL")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("使用 service 启动：service mysqld start\n\n使用 service 启动：service mysqld stop\n\n使用 service 启动：service mysqld restart\n\n")])])]),s("h2",{attrs:{id:"连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#连接"}},[t._v("#")]),t._v(" 连接")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("mysql -p localhost -u root -p\n")])])]),s("h2",{attrs:{id:"授权"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#授权"}},[t._v("#")]),t._v(" 授权")]),t._v(" "),s("p",[t._v("grant 权限 on 数据库对象 to 用户\n用户后面可以加@'ip地址' identified by '密码'")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("grant all on *.* to gj@'%'IDENTIFIED by '密码'\n")])])]),s("h2",{attrs:{id:"查询树结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询树结构"}},[t._v("#")]),t._v(" 查询树结构")]),t._v(" "),s("ul",[s("li",[t._v("创建函数")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("DELIMITER $$\nUSE `pv_web2`$$\n\nDROP FUNCTION\nIF EXISTS `getChildList`$$\n\nCREATE DEFINER = `root`@`%` FUNCTION `getChildList` (rootId VARCHAR(50)) RETURNS VARCHAR (4000) CHARSET utf8\nBEGIN\n\tDECLARE\n\t\tsChildList VARCHAR (4000) ; DECLARE\n\t\t\tsChildTemp VARCHAR (4000) ;\n\t\tSET sChildTemp = rootId;\n\t\tWHILE sChildTemp IS NOT NULL DO\n\n\t\tIF (sChildList IS NOT NULL) THEN\n\n\t\tSET sChildList = CONCAT(sChildList, ',', sChildTemp) ;\n\t\tELSE\n\n\t\tSET sChildList = CONCAT(sChildTemp) ;\n\t\tEND\n\t\tIF ; SELECT\n\t\t\tGROUP_CONCAT(open_id) INTO sChildTemp\n\t\tFROM\n\t\t\tsp_member_relation\n\t\tWHERE\n\t\t\tFIND_IN_SET(p_open_id, sChildTemp) > 0 ;\n\t\tEND\n\t\tWHILE ; RETURN sChildList ; END$$\n\nDELIMITER ;\n")])])]),s("ul",[s("li",[t._v("使用函数")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("select * from sp_member_relation where FIND_IN_SET(p_open_id, getChildList(1));\n")])])]),s("ul",[s("li",[t._v("查询所有函数与存储过程")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v(" SELECT * FROM information_schema.Routines\n")])])]),s("ul",[s("li",[t._v("查询单个函数")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("show create function getChildList\n")])])]),s("ul",[s("li",[t._v("函数调用")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('select getChildList("o_RE65KroiKWbuzBUT05KjTEMfQM")\n')])])]),s("ul",[s("li",[t._v("查询sql处理情况 元数据锁")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("#https://help.aliyun.com/document_detail/94566.html  \nshow full processlist\n")])])]),s("ul",[s("li",[t._v("查询数据库行锁")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("select l.* from \n( \n  select 'Blocker' role,    p.id,    p.user,    left(p.host, locate(':', p.host) - 1) host,    tx.trx_id,    tx.trx_state,    tx.trx_started, timestampdiff(second, tx.trx_started, now()) duration, lo.lock_mode, lo.lock_type, lo.lock_table, lo.lock_index,    tx.trx_query,    lw.requesting_trx_id Blockee_id,    lw.requesting_trx_id Blockee_trx\n  from    information_schema.innodb_trx tx,    \n      information_schema.innodb_lock_waits lw, \n      information_schema.innodb_locks lo,    \n      information_schema.processlist p\n  where    lw.blocking_trx_id = tx.trx_id and p.id = tx.trx_mysql_thread_id and lo.lock_id = lw.blocking_lock_id\n  union\n  select    'Blockee' role,    p.id,    p.user,    left(p.host, locate(':', p.host) - 1) host,    tx.trx_id,    tx.trx_state,    tx.trx_started, timestampdiff(second, tx.trx_started, now()) duration, lo.lock_mode, lo.lock_type, lo.lock_table, lo.lock_index,    tx.trx_query,    null,    null\n  from    information_schema.innodb_trx tx,    \n      information_schema.innodb_lock_waits lw, \n      information_schema.innodb_locks lo,    \n      information_schema.processlist p\n  where    lw.requesting_trx_id = tx.trx_id and p.id = tx.trx_mysql_thread_id and lo.lock_id = lw.requested_lock_id\n) l order by role desc, trx_state desc;  \n")])])])])}),[],!1,null,null,null);s.default=l.exports}}]);