(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{482:function(a,t,s){"use strict";s.r(t);var e=s(0),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"环境安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境安装"}},[a._v("#")]),a._v(" 环境安装")]),a._v(" "),t("ol",[t("li",[a._v("安装VM virtualBox")]),a._v(" "),t("li",[a._v("安装vagrant")]),a._v(" "),t("li",[a._v("检查安装是否成功")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant version\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("vagrant镜像仓库地址(https://app.vagrantup.com/boxes/search)")])]),a._v(" "),t("h2",{attrs:{id:"安装vagrant"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装vagrant"}},[a._v("#")]),a._v(" 安装vagrant")]),a._v(" "),t("ol",[t("li",[a._v("安装Centos7,会在当前文件夹下创建一个vagrant文件")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant init centos/7\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("启动Centos7")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant up\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("连接到Centos,使用vagrant用户")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant ssh\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("添加下面命令到Vagrantfile文件配置固定IP")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('config.vm.network "private_network", ip: "192.168.56.10"\n')])])]),t("ol",{attrs:{start:"5"}},[t("li",[a._v("重启vagrant")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant reload\n")])])]),t("h2",{attrs:{id:"配置tabby连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置tabby连接"}},[a._v("#")]),a._v(" 配置tabby连接")]),a._v(" "),t("ol",[t("li",[a._v("进入刚配置的虚拟机")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vagrant ssh \n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("使用命令进入root用户,配置root密码")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("su root\npassword:vagrant\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("修改sshd_config使root用户可以使用密码登录")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vi /etc/ssh/sshd_config\n")])])]),t("p",[t("img",{attrs:{src:"https://gj-blog.oss-cn-hangzhou.aliyuncs.com/blog-img/2022/04/202204061938634.png",alt:"image-20220406193850562"}})]),a._v(" "),t("p",[a._v("改为")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("PasswordAuthentication yes\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("重启服务")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("service sshd restart\n")])])]),t("h2",{attrs:{id:"安装docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[a._v("#")]),a._v(" 安装docker")]),a._v(" "),t("ol",[t("li",[a._v("删除旧版本")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("安装必要依赖")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo yum install -y yum-utils\n\nsudo yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("安装docker引擎")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo yum install docker-ce docker-ce-cli containerd.io\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("启动docker")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo systemctl start docker\n")])])]),t("ol",{attrs:{start:"5"}},[t("li",[a._v("设置开机自启动")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo systemctl enable docker\n")])])]),t("ol",{attrs:{start:"6"}},[t("li",[a._v("配置镜像加速器")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('sudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json <<-\'EOF\'\n{\n  "registry-mirrors": ["https://dkcvnb0h.mirror.aliyuncs.com"]\n}\nEOF\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n')])])]),t("h2",{attrs:{id:"配置idea插件连接docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置idea插件连接docker"}},[a._v("#")]),a._v(" 配置IDEA插件连接Docker")]),a._v(" "),t("ol",[t("li",[a._v("首先打开Docker配置文件")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vi  /usr/lib/systemd/system/docker.service\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("ExecStart后追加链接的端口")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("-H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("重启Docker")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("systemctl daemon-reload\nsystemctl restart docker\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("测试")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("http://192.168.56.10:2375/version #可以返回信息，说明已经配置成功\n")])])]),t("ol",{attrs:{start:"5"}},[t("li",[a._v("连接\n"),t("a",{attrs:{title:"",href:"https://gj-blog.oss-cn-hangzhou.aliyuncs.com/blog-img/2022-10-16-VDq3vM.png"}},[t("img",{attrs:{src:"https://gj-blog.oss-cn-hangzhou.aliyuncs.com/blog-img/2022-10-16-VDq3vM.png",alt:""}})])])]),a._v(" "),t("h2",{attrs:{id:"安装mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql"}},[a._v("#")]),a._v(" 安装mysql")]),a._v(" "),t("ol",[t("li",[a._v("下载mysql镜像")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo docker pull mysql:5.7\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("查看镜像")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo docker images\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("启动mysql容器")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("//切换root用户\nsu root \n\n# docker容器文件挂载与端口映射\ndocker run -p 3306:3306 --name mysql \\\n-v /mydata/mysql/log:/var/log/mysql \\\n-v /mydata/mysql/data:/var/lib/mysql \\\n-v /mydata/mysql/conf:/etc/mysql \\\n-e MYSQL_ROOT_PASSWORD=root \\\n-d mysql:5.7\n")])])]),t("p",[a._v("参数说明:")]),a._v(" "),t("p",[a._v("​\t-p 3306:3306 将容器的3306端口映射到主机的3306端口")]),a._v(" "),t("p",[a._v("​\t-v /mydata/mysql/log:/var/log/mysql \\ 将日志文件挂载到主机")]),a._v(" "),t("p",[a._v("​\t-v /mydata/mysql/data:/var/lib/mysql \\ 将数据文件挂载到主机")]),a._v(" "),t("p",[a._v("​\t-v /mydata/mysql/conf:/etc/mysql \\ 将配置文件挂载到主机")]),a._v(" "),t("p",[a._v("​\t-e MYSQL_ROOT_PASSWORD=root \\ 初始化root用户密码")]),a._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[a._v("进入交互模式")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("docker exec -it mysql /bin/bash\n")])])]),t("ol",{attrs:{start:"5"}},[t("li",[a._v("查看安装目录")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("whereis mysql\n")])])]),t("ol",{attrs:{start:"6"}},[t("li",[a._v("修改配置文件/mydata/mysql/conf/my.cnf")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n[mysqld]\ninit_connect='SET collation_connection = utf8_unicode_ci'\ninit_connect='SET NAMES utf8'\ncharacter-set-server=utf8\ncollation-server=utf8_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\n")])])]),t("ol",{attrs:{start:"7"}},[t("li",[a._v("重启mysql")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("docker restart mysql\n")])])]),t("ol",{attrs:{start:"8"}},[t("li",[a._v("进入容器查看")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[root@localhost conf]# docker exec -it mysql /bin/bash\nroot@3cee1a613904:/# cd /etc/mysql/\nroot@3cee1a613904:/etc/mysql# cat my.cnf\n[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n[mysqld]\ninit_connect='SET collation_connection = utf8_unicode_ci'\ninit_connect='SET NAMES utf8'\ncharacter-set-server=utf8\ncollation-server=utf8_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\nroot@3cee1a613904:/etc/mysql#\n")])])]),t("h2",{attrs:{id:"docker中安装redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker中安装redis"}},[a._v("#")]),a._v(" docker中安装redis")]),a._v(" "),t("ol",[t("li",[a._v("下载redis镜像")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[root@localhost conf]# docker pull redis\nUsing default tag: latest\nlatest: Pulling from library/redis\n69692152171a: Already exists                                                 a4a46f2fd7e0: Pull complete                                                 bcdf6fddc3bd: Pull complete                                                 b7e9b50900cc: Pull complete                                                 5f3030c50d85: Pull complete                                                 63dae8e0776c: Pull complete                                                 Digest:sha256:365eddf64356169aa0cbfbeaf928eb80762de3cc364402e7653532bcec912973\nStatus: Downloaded newer image for redis:latest\ndocker.io/library/redis:latest\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("创建目录结构")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[root@hadoop-104 ~]# mkdir -p /mydata/redis/conf\n[root@hadoop-104 ~]# touch /mydata/redis/conf/redis.conf\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("启动redis")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("docker run -p 6379:6379 --name redis -v /mydata/redis/data:/data \\\n-v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf \\\n-d redis redis-server /etc/redis/redis.conf\n")])])]),t("ol",{attrs:{start:"4"}},[t("li",[a._v("进入redis客户端")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("docker exec -it redis redis-cli\n")])])]),t("h2",{attrs:{id:"docker配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker配置"}},[a._v("#")]),a._v(" docker配置")]),a._v(" "),t("p",[a._v("设置mysql和redis跟随虚拟机重启")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sudo docker update mysql --restart=always\nsudo docker update redis --restart=always\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);